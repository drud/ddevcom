'use strict';window.tsfTitle=function(a){const b="undefined"!=typeof tsfTitleL10n&&tsfTitleL10n,c=tsf.escapeString(b.params.untitledTitle),d=tsf.escapeString(b.i18n.protectedTitle),e=tsf.escapeString(b.i18n.privateTitle),f=!!b.params.stripTitleTags,g=new Map;let h={},i=new Map,j=new Map;const k=a=>i.get(a)||"",l=a=>j.get(a)||"",m=(a,b)=>i.set(a,b)&&k(a),n=(a,b)=>j.set(a,b)&&l(a),o=a=>document.getElementById("tsf-title-placeholder-prefix_"+a)||document.createElement("span"),p=a=>document.getElementById("tsf-title-placeholder-additions_"+a)||document.createElement("span"),q=a=>g.get(a);let r;const s=()=>{if(r)return r;for(const a of g.keys())if(t(a,"hasLegacy"))return r=a},t=(a,b)=>("useTagline"===b&&(tsf.deprecatedFunc("tsfTitle.getStateOf( id, 'useTagline' )","4.1.0","tsfTitle.getStateOf( id, 'addAdditions' )"),b="addAdditions"),b?b in h[a]?h[a][b]:void 0:h[a]),u=(a,b,c)=>{if(a in h)switch("useTagline"===b&&(tsf.deprecatedFunc("tsfTitle.updateStateOf( id, 'useTagline' )","4.1.0","tsfTitle.updateStateOf( id, 'addAdditions' )"),b="addAdditions"),h[a][b]=c,b){case"prefixValue":case"prefixPlacement":z(a),J(a);break;case"addAdditions":case"separator":case"additionValue":case"additionPlacement":y(a),J(a);break;case"useSocialTagline":case"allowReferenceChange":case"defaultTitle":default:J(a);}},v=a=>{let b=[document.getElementById("tsf-title-reference_"+a)];if(t(a,"hasLegacy")){let a=document.getElementById("tsf-title-reference");a&&b.unshift(a)}return b},w=a=>[document.getElementById("tsf-title-noadditions-reference_"+a)],x=a=>{let b=v(a.target.id),c=w(a.target.id);if(!b[0]||!c[0])return;let d=t(a.target.id,"allowReferenceChange"),e=d&&a.target.value||t(a.target.id,"defaultTitle")||"",f="";if(e=e.trim(),f=e,e.length&&d){let b=l(a.target.id),c=k(a.target.id);if(b.length){switch(t(a.target.id,"prefixPlacement")){case"before":tsf.l10n.states.isRTL?e+=b:e=b+e;break;case"after":tsf.l10n.states.isRTL?e=b+e:e+=b;}f=e}if(c.length)switch(t(a.target.id,"additionPlacement")){case"before":e=c+e;break;case"after":e+=c;}}let g=tsf.escapeString(tsf.decodeEntities(tsf.sDoubleSpace(e.trim()))),h=tsf.escapeString(tsf.decodeEntities(tsf.sDoubleSpace(f.trim())));b.forEach(a=>{a.innerHTML=g,setTimeout(()=>{a.dispatchEvent(new Event("change"))},0)}),c.forEach(a=>{a.innerHTML=h,setTimeout(()=>{a.dispatchEvent(new Event("change"))},0)})},y=a=>{let b="",c="",d="";if(t(a,"addAdditions")&&(c=tsf.escapeString(tsf.decodeEntities(t(a,"additionValue"))),d=t(a,"separator")),c)switch(t(a,"additionPlacement")){case"before":b=c+" "+d+" ";break;case"after":b=" "+d+" "+c;}p(a).innerHTML=m(a,b||"")},z=a=>{let b="",c=t(a,"prefixValue");if(c)switch(t(a,"prefixPlacement")){case"before":b=tsf.l10n.states.isRTL?" "+c:c+" ";break;case"after":b=tsf.l10n.states.isRTL?c+" ":" "+c;}o(a).innerHTML=n(a,b||"")},A=b=>{var c=Math.round;let d=p(b.target.id),e=o(b.target.id);if(!d&&!e)return;const f=b.target,g=b.target.value;let h=l(b.target.id),i=k(b.target.id),j=!!h.length,m=!!i.length;if(!j&&e&&(e.style.display="none"),!m&&d&&(d.style.display="none"),!j&&!m)return void(f.style.textIndent="initial");if(!g.length)return f.style.textIndent="initial",e&&(e.style.display="none"),void(d&&(d.style.display="none"));const n=a(f);let q=n.outerWidth(!0),r=(n.outerHeight(!0)-n.height())/2,s=parseInt(n.css("marginTop"))/2,u=parseInt(n.css("marginBottom"))/2,v=(q-n.innerWidth())/2,w=tsf.l10n.states.isRTL?"right":"left",x=(q-n.width())/2,y={display:n.css("display"),lineHeight:n.css("lineHeight"),fontFamily:n.css("fontFamily"),fontWeight:n.css("fontWeight"),fontSize:n.css("fontSize"),letterSpacing:n.css("letterSpacing"),marginTop:s+"px",marginBottom:u+"px",paddingTop:r+"px",paddingBottom:r+"px"};const z=a(e),A=a(d);let B=0,C=0,D=0,E=0,F=0,G=0;if(j&&(z.css(y),z.css({maxWidth:"initial"}),F=e.getBoundingClientRect().width,F<G&&(F=0)),m){let c=0;switch((()=>{let d=document.getElementById(`tsf-title-offset_${b.target.id}`),e=a(d);e.text(g),e.css({fontFamily:y.fontFamily,fontWeight:y.fontWeight,letterSpacing:y.letterSpacing,fontSize:y.fontSize}),c=d.getBoundingClientRect().width})(),B=f.getBoundingClientRect().width-v-x-c-F,B<G&&(F+=B,B=0),A.css(y),A.css({maxWidth:"initial"}),t(b.target.id,"additionPlacement")){case"before":let e=d.getBoundingClientRect().width;e=B<e?B:e,e<G&&(e=0),B=e,E+=B,D+=B,C+=x;break;case"after":C+=x+c+F;}}D+=x,F=0>F?0:F,E+=F;let H;j&&(H={},H[w]=D+"px",H.maxWidth=F+"px",z.css(H)),m&&(H={},H[w]=C+"px",H.maxWidth=B+"px",A.css(H)),H={},H["text-indent"]=c(E)+"px",n.css(H)},B=a=>{a.target.placeholder=v(a.target.id)[0].innerText},C=a=>{if("tsfC"in window){let b=document.getElementById(a.target.id+"_chars"),c=v(a.target.id)[0];b&&tsfC.updateCharacterCounter({e:b,text:c.innerHTML,field:"title",type:"search"})}},D=a=>{if("tsfC"in window){let b=document.getElementById(a.target.id+"_pixels"),c=v(a.target.id)[0];b&&tsfC.updatePixelCounter({e:b,text:c.innerHTML,field:"title",type:"search"})}},E=a=>{if(a){let b=q(a);b&&b.dispatchEvent(new Event("input"))}else g.forEach(a=>a.id&&E(a.id))},F=a=>{if(a){let b=q(a);b&&b.dispatchEvent(new CustomEvent("tsf-update-title-counter"))}else g.forEach(a=>a.id&&F(a.id))},G=a=>{A(a),x(a),B(a),H(a)},H=a=>{C(a),D(a)};let I={};const J=a=>{a in I&&clearTimeout(I[a]),I[a]=setTimeout(()=>E(a),10)},K=a=>{if("tsfAys"in window){let b=tsfAys.areSettingsChanged();E(a),!b&&tsfAys.areSettingsChanged()&&tsfAys.reset()}else E(a)};let L={};const M=a=>{a in L&&clearTimeout(L[a]),L[a]=setTimeout(()=>K(a),10)},N=a=>{let b=document.getElementById(a.target.dataset.for);if(b){let c=a.target.classList.contains("tsf-title-placeholder-additions")?"additions":"prefix",d=b.value;switch(b.focus(),a.detail){case 3:b.setSelectionRange(0,d.length);break;case 2:let e,f;"additions"===c&&"after"===t(b.id,"additionPlacement")||"prefix"===c&&tsf.l10n.states.isRTL?(e=d.replace(/(\w+|\s+)$/u,"").length,f=d.length):(e=0,f=d.length-d.replace(/^(\s+|\w+)/u,"").length),b.setSelectionRange(e,f);break;case 1:default:let g="additions"===c&&"after"===t(b.id,"additionPlacement")?d.length:0;b.setSelectionRange(g,g);}}},O=a=>a.preventDefault();let P=window.innerWidth;const Q=()=>{let a=window.innerWidth;P<a?782>=P&&782<=a&&K():782<=P&&782>=a&&K(),P=a},R=()=>{a(document).on("wp-window-resized",Q),window.addEventListener("tsf-counter-updated",()=>M())},S=a=>{if(!(!a instanceof Element)){a.addEventListener("input",G),a.addEventListener("tsf-update-title-counter",H);let b=o(a.id),c=p(a.id);b.addEventListener("click",N),c.addEventListener("click",N),b.addEventListener("mousedown",O),c.addEventListener("mousedown",O),y(a.id),z(a.id),M(a.id)}};return Object.assign({load:()=>{document.body.addEventListener("tsf-onload",R)}},{setInputElement:a=>(g.set(a.id,a),h[a.id]={allowReferenceChange:!0,defaultTitle:"",separator:b.states.titleSeparator,prefixPlacement:b.states.prefixPlacement},S(a),q(a.id)),getInputElement:q,getState:a=>(tsf.deprecatedFunc("tsfTitle.getState()","4.1.0","tsfTitle.getStateOf()"),t(s(),a)),getStateOf:t,updateState:(a,b)=>(tsf.deprecatedFunc("tsfTitle.updateState()","4.1.0","tsfTitle.updateStateOf()"),u(s(),a,b)),updateStateOf:u,updateStateAll:(a,b)=>{g.forEach(c=>{u(c.id,a,b)})},triggerCounter:F,triggerInput:E,enqueueTriggerInput:J,triggerUnregisteredInput:K,enqueueUnregisteredInputTrigger:M},{l10n:b,untitledTitle:c,privatePrefix:e,protectedPrefix:d,stripTitleTags:f})}(jQuery),window.tsfTitle.load();
