'use strict';window.tsfGBC=function(a){function b(a){return k.getEditedPostAttribute(a)}function c(){n={title:b("title"),link:k.getPermalink(),content:b("content"),excerpt:b("excerpt"),visibility:k.getEditedPostVisibility()}}function d(a){return n[a]||null}function e(){let a=n;c(),a.title!==n.title&&o("title"),a.link!==n.link&&o("link"),a.content!==n.content&&o("content"),a.excerpt!==n.excerpt&&o("excerpt"),a.visibility!==n.visibility&&o("visibility")}function f(){p?k.didPostSaveRequestSucceed()?(s(),r()&&r().cancel(),g()):r():k.isSavingPost()&&(k.isPreviewingPost()?(p=!0,q="preview"):k.isAutosavingPost()?(p=!0,q="autosave"):(p=!0,q="save"))}function g(){p=!1}function h(){if(k.isPostSavingLocked())3>++t?s():(s()&&s().cancel(),t=0);else{t=0;let a=!k.hasChangedContent();"preview"===q?document.dispatchEvent(new CustomEvent("tsf-gutenberg-onpreview")):"autosave"===q?document.dispatchEvent(new CustomEvent("tsf-gutenberg-onautosave")):"save"===q?a=!0:void 0;a&&document.dispatchEvent(new CustomEvent("tsf-gutenberg-onsave"))&&document.dispatchEvent(new CustomEvent("tsf-gutenberg-onsave-completed")),document.dispatchEvent(new CustomEvent("tsf-gutenberg-saved-document",{detail:{savedType:q}})),q=""}}function i(){l.isEditorSidebarOpened()?!u.opened&&(u.opened=!0,document.dispatchEvent(new CustomEvent("tsf-gutenberg-sidebar-opened"))):u.opened&&(u.opened=!1,document.dispatchEvent(new CustomEvent("tsf-gutenberg-sidebar-closed")))}const j="undefined"!=typeof tsfGBCL10n&&tsfGBCL10n,k=wp.data.select("core/editor"),l=wp.data.select("core/edit-post"),{debounce:m}=lodash;let n;const o=b=>{a(document).trigger("tsf-updated-gutenberg-"+b,[d(b)])};let p=!1,q="";const r=m(g,7e3),s=m(h,500);let t=0,u={opened:!1};const v=()=>{wp.data.subscribe(m(i,500)),wp.data.subscribe(m(e,300)),wp.data.subscribe(f),setTimeout(()=>{c(),o("title"),o("link"),o("content"),o("excerpt"),o("visibility"),document.dispatchEvent(new CustomEvent("tsf-subscribed-to-gutenberg"))})};return Object.assign({load:()=>{document.body.addEventListener("tsf-onload",v)}},{triggerUpdate:o},{l10n:j})}(jQuery),window.tsfGBC.load();
