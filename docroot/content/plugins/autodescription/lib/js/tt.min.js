'use strict';window.tsfTT=function(a){const b="tsf-tooltip",c=`.${b}`,d="tsf-tooltip-item",e=`.${d}`,f=`.${"tsf-tooltip-wrap"}`,g=()=>{let a,g,j=!1,n=!1,o={},p={};try{(()=>{const a={get passive(){return j=!0,!1},get capture(){return n=!0,!1}};window.addEventListener("tsf-tt-test-passive",null,a),window.removeEventListener("tsf-tt-test-passive",null,a)})()}catch(a){j=!1,n=!1}const q=(a,b)=>{b=b||!1;let c={mousemove:y,mouseleave:z,mouseout:z,blur:z},d=["pointerdown","touchstart","click"];if(b){for(const[b,d]of Object.entries(c))a.removeEventListener(b,d);d.forEach(a=>{document.body.removeEventListener(a,A)})}else{for(const[b,d]of Object.entries(c))a.addEventListener(b,d);d.forEach(a=>{document.body.addEventListener(a,A)})}a.addEventListener("tsf-tooltip-update",s)},r=a=>q(a,!0),s=a=>{if(a.target.classList.contains(d)){let b=a.target.querySelector(".tsf-tooltip-text");b instanceof Element&&(b.innerHTML=a.target.dataset.desc,a.target.dispatchEvent(new Event("mousemove")))}},t=()=>{a=requestAnimationFrame(v)},u=()=>{g=void 0,p={tooltip:void 0,arrow:void 0,wrap:void 0},o={last:{x:void 0},curr:{x:void 0}},cancelAnimationFrame(a)},v=()=>{var a=Math.round;let b=![o.curr.x].includes(NaN);if(b&&o.curr.x===o.last.x)return void t();o.last.x=o.curr.x;const d=g;let e=p.tooltip||d&&d.target.querySelector(c);if(!e)return void t();p.tooltip||(p.tooltip=e),p.arrow||(p.arrow=e.querySelector(".tsf-tooltip-arrow")),p.wrap||(p.wrap=d.target.closest(f)||d.target.parentNode);let h=o.curr.x,i=7,j=16;"focus"===d.type?h=d.target.getBoundingClientRect().left+d.target.offsetWidth/2:isNaN(h)&&(h=p.tooltip.dataset.lastPagex||d.target.getBoundingClientRect().left),p.tooltip.dataset.lastPagex=h;let k=h-p.wrap.getBoundingClientRect().left-j/2,l=p.tooltip.querySelector(".tsf-tooltip-text-wrap"),m=l.offsetWidth,n=p.tooltip.dataset.adjust,q=m-j-i;if(n=parseInt(n,10),n=isNaN(n)?0:a(n),n&&(k-=n,q+n>p.wrap.offsetWidth)){let a=l.querySelector(".tsf-tooltip-text"),b=a.offsetWidth;q=b-j-i}p.arrow.style.left=k<=i?i+"px":k>=q?q+"px":k+"px",b?t():u()},w=a=>{k(a.target)||(a.preventDefault(),setTimeout(()=>i(a.target)))},x=a=>{let c=a.target.dataset.desc||a.target.title||"";c&&!a.target.getElementsByClassName(b).length&&(a.target.dataset.desc=c,a.target.removeAttribute("title"),h(a,a.target,c))},y=a=>{o.curr.x=a.pageX||NaN,g=a},z=a=>{m(a.target),r(a.target),u()},A=a=>{if(a.target.dataset.hasTooltip)return;if(a.target instanceof HTMLInputElement&&a.target.id){let b=document.querySelectorAll(`label[for="${a.target.id}"]`);if(b.length&&[...b].some(a=>a.dataset.hasTooltip))return}let b;if(a.target.classList.contains(d)&&(b=a.target),!b){let d=a.target.querySelectorAll(e);for(const a of d)if(a.querySelector(c)){b=a;break}}if(b)for(const a of document.querySelectorAll(c))a.closest(e)!==b&&(m(a),r(a));else{for(const a of document.querySelectorAll(e))m(a),r(a);u()}},B=a=>{if(a.target.dataset.hasTooltip)return;let b=!1;switch(a.type){case"mouseenter":break;case"pointerdown":case"touchstart":b=!0;break;case"focus":default:}b?A(a):i(a.target),u(),x(a),y(a),t(),q(a.target)};let C=!1;const D=a=>{C||(C=!0,a.target.classList.contains(d)&&B(a),a.stopPropagation(),C=!1)};let E;const F=!(j||n)||{capture:!0,passive:!0},G=()=>{clearTimeout(E),E=setTimeout(()=>{let a=document.querySelectorAll(f),b="mouseenter pointerdown touchstart focus".split(" ");for(let c=0;c<a.length;c++)b.forEach(b=>{a[c].addEventListener(b,D,F)}),a[c].addEventListener("click",w,!!n&&{capture:!1})},25)};G(),window.addEventListener("tsf-tooltip-reset",G),l("#wpwrap")},h=(d,e,g)=>{var h=Math.min;if(e instanceof a&&(e=e.get(0)),e.dataset.hasTooltip=1,e.querySelector(c)&&m(e),!g.length)return;let i=document.createElement("div");i.classList.add(b),i.insertAdjacentHTML("afterbegin",`<span class="tsf-tooltip-text-wrap"><span class="tsf-tooltip-text">${g}</span></span><div class="tsf-tooltip-arrow" style=will-change:left></div>`),e.prepend(i);let j=e.closest(".tsf-tooltip-boundary")||document.body,k=j.getBoundingClientRect(),l=k.top-(j.scrollTop||0),n=j.offsetWidth,o=250,p=12,q=e.closest(f)||e.parentElement,r=q.getBoundingClientRect(),s=i.querySelector(".tsf-tooltip-text-wrap"),t=s.getBoundingClientRect(),u=r.width;t.width>o&&u<o&&150<u&&(s.style.flexBasis=u+"px"),s.offsetWidth>n-p/2?(s.style.flexBasis=h(o,n-p)+"px",p/=2):t.width>o&&(s.style.flexBasis=o+"px");let v=k.left-(j.scrollLeft||0),w=v+n,x=s.offsetWidth,y=t.left,z=y+x,A=0;if(y<v)A=v-y+p;else if(z>w)A=w-y-x-p;else if(42>u)A=-u/2-p;else if(u>x){let a=d&&d.pageX||NaN;A=d&&"focus"===d.type?u/2-x/2:isNaN(a)?-p:a-r.left-x/2;let b=-p,c=u-x+p;A<b&&(A=b),A>c&&(A=c)}if(A+y<v+p){let a=A+y-(v+p/2);A-=a}if(A+z>w+p){let a=A+z-(w+p/2);A-=a}if(A+y<v&&(A=0),!d){let a=parseInt(s.style.flexBasis,10);A<-a&&(A=-a)}i.style.left=A+"px",i.dataset.adjust=A;let B=e.offsetHeight+8,C=i.getBoundingClientRect().top-B;l>C?(i.classList.add("tsf-tooltip-down"),i.style.top=B+"px"):i.style.bottom=B+"px"},i=a=>{if(a instanceof Element){if(a.dataset.preventedClick=1,a instanceof HTMLLabelElement&&a.htmlFor){let b=document.getElementById(a.htmlFor);b&&(b.dataset.preventedClick=1)}a instanceof HTMLInputElement&&a.id&&document.querySelectorAll(`label[for="${a.id}"]`).forEach(a=>{a.dataset.preventedClick=1})}},j=a=>{if(a instanceof Element){if(delete a.dataset.preventedClick,a instanceof HTMLLabelElement&&a.htmlFor){let b=document.getElementById(a.htmlFor);b&&delete b.dataset.preventedClick}a instanceof HTMLInputElement&&a.id&&document.querySelectorAll(`label[for="${a.id}"]`).forEach(a=>{delete a.dataset.preventedClick})}},k=a=>a instanceof Element&&+a.dataset.preventedClick,l=a=>a instanceof Element&&a.classList.add("tsf-tooltip-boundary"),m=b=>{b instanceof a&&(b=b.get(0)),b instanceof HTMLElement&&(delete b.dataset.hasTooltip,j(b)),n(b).remove()},n=b=>a(b).find(c).first();return Object.assign({load:()=>{document.body.addEventListener("tsf-ready",g)}},{doTooltip:h,removeTooltip:m,getTooltip:n,addBoundary:l,triggerReset:()=>{window.dispatchEvent(new CustomEvent("tsf-tooltip-reset"))},triggerUpdate:a=>{if(a&&a instanceof Element||(a=document.querySelectorAll(e)),!a)return;const b=new CustomEvent("tsf-tooltip-update");a instanceof Element?a.dispatchEvent(b):a instanceof Nodelist&&a.forEach(a=>a.dispatchEvent(b))}})}(jQuery),window.tsfTT.load();
