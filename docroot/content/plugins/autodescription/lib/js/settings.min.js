'use strict';window.tsfSettings=function(a){const b="undefined"!=typeof tsfSettingsL10n&&tsfSettingsL10n,c=a=>`autodescription-site-settings[${a}]`,d=()=>{const b=a(window),d=document.getElementById(c("display_character_counter"));d&&d.addEventListener("click",a=>{document.querySelectorAll(".tsf-counter-wrap").forEach(b=>{b.style.display=a.target.checked?"":"none"}),a.target.checked&&tsfC.triggerCounterUpdate()});const e=document.getElementById(c("display_pixel_counter"));e&&e.addEventListener("click",a=>{document.querySelectorAll(".tsf-pixel-counter-wrap").forEach(b=>{b.style.display=a.target.checked?"":"none"}),a.target.checked&&tsfC.triggerCounterUpdate()});const f=wp.template("tsf-disabled-post-type-help")(),g=wp.template("tsf-disabled-taxonomy-help")(),h=wp.template("tsf-disabled-taxonomy-from-pt-help")(),i=a=>tsf.escapeString("tsf-disabled-post-type-input-clone-"+a),j=a=>tsf.escapeString("tsf-disabled-taxonomy-input-clone-"+a),k=a=>[document.getElementById(`${c("noindex_post_types")}[${a}]`),document.getElementById(`${c("nofollow_post_types")}[${a}]`),document.getElementById(`${c("noarchive_post_types")}[${a}]`)].filter(a=>a),l=a=>[document.getElementById(`${c("noindex_taxonomies")}[${a}]`),document.getElementById(`${c("nofollow_taxonomies")}[${a}]`),document.getElementById(`${c("noarchive_taxonomies")}[${a}]`)].filter(a=>a),m=(b,c)=>{c?(k(b).forEach(c=>{if(c){let d=c.cloneNode(!0);d.type="hidden",d.value=c.checked?c.value:"",d.id+="-cloned",d.classList.add(i(b)),c.disabled=!0,c.dataset.disabledWarning=1,a(c.closest("label")).append(f).append(d)}}),tsfTT.triggerReset()):k(b).forEach(a=>{a&&a.dataset.disabledWarning&&(a.closest("label").querySelector(".tsf-post-type-warning").remove(),document.querySelectorAll("."+i(b)).forEach(a=>{a.remove()}),a.disabled=!1,a.dataset.disabledWarning="")})},n=(b,c)=>{c?(l(b).forEach(c=>{if(c){let d=c.cloneNode(!0);d.type="hidden",d.value=c.checked?c.value:"",d.id+="-cloned",d.classList.add(j(b)),c.disabled=!0,c.dataset.disabledWarning=1,a(c.closest("label")).append(g).append(d)}}),tsfTT.triggerReset()):l(b).forEach(a=>{a&&a.dataset.disabledWarning&&(a.closest("label").querySelector(".tsf-taxonomy-warning").remove(),document.querySelectorAll("."+j(b)).forEach(a=>{a.remove()}),a.disabled=!1,a.dataset.disabledWarning="")})},o=(b,d)=>{let e=document.getElementById(`${c("disabled_taxonomies")}[${b}]`);d?(a(e.closest("label")).append(h),tsfTT.triggerReset()):e.closest("label").querySelector(".tsf-taxonomy-from-pt-warning").remove()},p=new Set,q=new Set,r=new Set,s=new Set,t=()=>{let a=document.querySelectorAll(".tsf-excluded-taxonomies"),b=!1;a.forEach(a=>{let c=a.name.split(/(?:.+\[)(.+?)(?:])/).join(""),d=JSON.parse(a.dataset.postTypes),e=d.every(a=>p.has(a));e?(!s.has(c)&&(b=!0),s.add(c)):s.has(c)&&(s.delete(c),b=!0),b&&w(c)})};let u=new Map;const v=a=>u.get(a)||new Set;b.on("tsf-post-type-support-changed",(a,b)=>{m(b,p.has(b)),t()}),b.on("tsf-taxonomy-support-changed",(a,b)=>{v("excludedTaxonomiesAll").size!==r.size&&n(b,r.has(b)),v("excludedPtTaxonomies").size!==s.size&&o(b,s.has(b)),u.set("excludedTaxonomiesAll",new Set(r)),u.set("excludedTaxonomies",new Set(q)),u.set("excludedPtTaxonomies",new Set(s))});const w=a=>{r.clear(),q.forEach(a=>r.add(a)),s.forEach(a=>r.add(a)),b.trigger("tsf-taxonomy-support-changed",[a,r,q,s])};let x=!1;const y=a=>{if(a.target.name){let c=a.target.name.split(/(?:.+\[)(.+?)(?:])/).join("");a.target.checked?(p.add(c),b.trigger("tsf-post-type-support-changed",[c,p])):x&&(p.delete(c),b.trigger("tsf-post-type-support-changed",[c,p]))}},z=a=>{if(a.target.name){let b=a.target.name.split(/(?:.+\[)(.+?)(?:])/).join("");a.target.checked?(q.add(b),w(b)):x&&(q.delete(b),w(b))}},A=new Event("change");document.querySelectorAll(".tsf-excluded-post-types").forEach(a=>{a.addEventListener("change",y),a.dispatchEvent(A)}),document.querySelectorAll(".tsf-excluded-taxonomies").forEach(a=>{a.addEventListener("change",z),a.dispatchEvent(A)}),x=!0},e=()=>{document.querySelectorAll(".tsf-color-picker").forEach(b=>{let c=a(b),d="",e=c.data("tsf-default-color");c.wpColorPicker({defaultColor:e,width:238,change:()=>{d=c.wpColorPicker("color"),""===d&&(d=e),b.value=e,tsfAys.registerChange()},clear:()=>{e.length&&(b.value=e,c.closest(".wp-picker-container").find(".wp-color-result").css("backgroundColor",e)),tsfAys.registerChange()},palettes:!1})})},f=()=>{const b=document.getElementById(c("title_rem_additions")),d=document.getElementById(c("social_title_rem_additions")),e=wp.template("tsf-disabled-title-additions-help")();b&&(b.addEventListener("change",()=>{b.checked?(document.querySelectorAll(".tsf-title-additions-js").forEach(a=>a.style.display="none"),d&&(d.dataset.disabledWarning=1,a(d.closest("label")).append(e),tsfTT.triggerReset())):(document.querySelectorAll(".tsf-title-additions-js").forEach(a=>a.style.display="inline"),d&&d.dataset.disabledWarning&&d.closest("label").querySelector(".tsf-title-additions-warning").remove())}),b.dispatchEvent(new Event("change")));const f=a=>{let b="left"===a.target.value;document.querySelectorAll(".tsf-title-additions-example-left").forEach(a=>{a.style.display=b?"inline":"none"}),document.querySelectorAll(".tsf-title-additions-example-right").forEach(a=>{a.style.display=b?"none":"inline"})};document.querySelectorAll("#tsf-title-location input").forEach(a=>{a.addEventListener("click",f)});const g=document.getElementById(c("title_rem_prefixes"));g&&g.addEventListener("click",a=>{document.querySelectorAll(".tsf-title-prefix-example").forEach(b=>{b.style.display=a.target.checked?"none":"inline"})});const h=a=>{const b=tsf.decodeEntities(a.target.dataset.entity),c="tsf-title-separator-active";document.querySelectorAll(".tsf-sep-js").forEach(a=>{a.innerText=` ${b} `}),window.dispatchEvent(new CustomEvent("tsf-title-sep-updated",{detail:{separator:b}}));let d=document.querySelector(`.${c}`);d&&d.classList.remove(c,"tsf-no-focus-ring");let e=document.querySelector(`label[for="${a.target.id}"]`);e&&e.classList.add(c)};document.querySelectorAll("#tsf-title-separator input").forEach(a=>{a.addEventListener("click",h)});const i=a=>{a.target.classList.add("tsf-no-focus-ring")};document.querySelectorAll("#tsf-title-separator label").forEach(a=>{a.addEventListener("click",i)})},g=()=>{const d=c("homepage_title"),e=document.getElementById(d),f=document.getElementById(c("homepage_title_tagline")),g=document.getElementById(c("homepage_tagline"));tsfTitle.setInputElement(e);let h=JSON.parse(document.getElementById("tsf-title-data_"+d).dataset.state);tsfTitle.updateStateOf(d,"allowReferenceChange",!h.refTitleLocked),tsfTitle.updateStateOf(d,"defaultTitle",h.defaultTitle.trim()),tsfTitle.updateStateOf(d,"addAdditions",h.addAdditions),tsfTitle.updateStateOf(d,"useSocialTagline",!!(h.useSocialTagline||!1)),tsfTitle.updateStateOf(d,"additionValue",h.additionValue.trim()),tsfTitle.updateStateOf(d,"additionPlacement",h.additionPlacement),tsfTitle.updateStateOf(d,"hasLegacy",!!(h.hasLegacy||!1)),tsfTitle.enqueueUnregisteredInputTrigger(d);const i=a=>{let b=tsfTitle.getStateOf(d,"additionPlacement"),c="left"===a.target.value?"before":"after";c!==b&&tsfTitle.updateStateOf(d,"additionPlacement",c)};document.querySelectorAll("#tsf-home-title-location input").forEach(a=>{a.addEventListener("click",i)});const j=a=>{let b=tsfTitle.getStateOf(d,"prefixValue"),c="";switch(a){case"password":c=tsfTitle.protectedPrefix;break;case"private":c=tsfTitle.privatePrefix;break;default:case"public":c="";}c!==b&&tsfTitle.updateStateOf(d,"prefixValue",c)};b.states.isFrontPrivate?j("private"):b.states.isFrontProtected&&j("password");e.addEventListener("input",a=>{let b=document.querySelectorAll(".tsf-custom-title-js"),c=tsf.decodeEntities(tsf.sDoubleSpace(a.target.value.trim()));c.length?(c=tsf.escapeString(c),b.forEach(a=>a.innerHTML=c)):(c=tsf.escapeString(tsf.decodeEntities(tsfTitle.getStateOf(d,"defaultTitle"))),b.forEach(a=>a.innerHTML=c))}),e.dispatchEvent(new Event("input"));let k,l=a(".tsf-custom-tagline-js");const m=()=>{clearTimeout(k),k=setTimeout(()=>{let b=tsfTitle.getStateOf(d,"additionValue");b=tsf.decodeEntities(tsf.sDoubleSpace(b.trim())),b.length&&tsfTitle.getStateOf(d,"addAdditions")?(l.html(tsf.escapeString(b)),a(".tsf-custom-blogname-js").show()):a(".tsf-custom-blogname-js").hide()})};f.addEventListener("input",()=>{let a=tsfTitle.getStateOf(d,"additionValue"),b=f.value.trim();b.length||(b=f.placeholder||""),b=tsf.escapeString(tsf.decodeEntities(b.trim())),a!==b&&(tsfTitle.updateStateOf(d,"additionValue",b),m())}),f.dispatchEvent(new Event("input"));g.addEventListener("change",a=>{let b=!1;a.target.checked?(b=!0,f.readOnly=!1):(b=!1,f.readOnly=!0),tsfTitle.updateStateOf(d,"addAdditions",b),m()}),g.dispatchEvent(new Event("change"));window.addEventListener("tsf-title-sep-updated",a=>{tsfTitle.updateStateAll("separator",a.detail.separator)})},h=()=>{const a=c("homepage_description");let b=JSON.parse(document.getElementById("tsf-description-data_"+a).dataset.state);tsfDescription.setInputElement(document.getElementById(a)),tsfDescription.updateStateOf(a,"defaultDescription",b.defaultDescription.trim()),tsfDescription.updateStateOf(a,"hasLegacy",!!(b.hasLegacy||!1)),tsfDescription.enqueueUnregisteredInputTrigger(a)},i=()=>{const b=()=>{tsfTitle.enqueueUnregisteredInputTrigger(c("homepage_title")),tsfDescription.enqueueUnregisteredInputTrigger(c("homepage_description"))};a(document).on("postbox-toggled",function(a,c){if("autodescription-homepage-settings"===c.id){let a=c.querySelector(".inside");0<a.offsetHeight&&0<a.offsetWidth&&b()}});const d=document.getElementById("tsf-homepage-tab-general");d&&d.addEventListener("tsf-tab-toggled",b)},j=()=>{const a=document.getElementById(c("social_title_rem_additions"));a&&a.addEventListener("change",a=>{a.target.checked?tsfTitle.updateStateAll("useSocialTagline",!1):tsfTitle.updateStateAll("useSocialTagline",!0)})},k=()=>{const b=document.getElementById(c("set_copyright_directives"));if(b){const a=["max_snippet_length","max_image_preview","max_video_preview"].map(a=>document.getElementById(c(a))),d="tsf-toggle-directives-surrogate";b.addEventListener("change",b=>{b.target.checked?(a.forEach(a=>a.disabled=!1),document.querySelectorAll(`.${d}`).forEach(a=>a.remove())):a.forEach(a=>{a.disabled=!0;let b=document.createElement("input");b.type="hidden",b.name=a.name||"",b.value=a.value||0,b.classList.add(d),a.insertAdjacentElement("afterend",b)})}),b.dispatchEvent(new Event("change"))}const d=a(window),e=wp.template("tsf-robots-pt-help")(),f={},g={};[f,g].forEach(a=>{a.noindex=new Set,a.nofollow=new Set,a.noarchive=new Set});const h=(b,d,f)=>{let g=document.getElementById(`${c(`${d}_taxonomies`)}[${b}]`);f?(a(g.closest("label")).append(e),tsfTT.triggerReset()):g.closest("label").querySelector(".tsf-taxonomy-from-pt-robots-warning").remove(),m(b)},i=a=>{let b=document.querySelectorAll(`.tsf-robots-taxonomies[data-robots="${a}"]`),c=!1;b.forEach(b=>{let d=b.name.split(/(?:.+\[)(.+?)(?:])/).join(""),e=JSON.parse(b.dataset.postTypes),h=e.every(b=>f[a].has(b));h?(!g[a].has(d)&&(c=!0),g[a].add(d)):g[a].has(d)&&(g[a].delete(d),c=!0),c&&l(d,a)})};let j={noindex:new Map,nofollow:new Map,noarchive:new Map};const k=(a,b)=>j[b].get(a)||new Set;d.on("tsf-post-type-robots-changed",(a,b,c)=>{i(c)}),d.on("tsf-taxonomy-robots-changed",(a,b,c)=>{k("robotsPtTaxonomies",c).size!==g[c].size&&h(b,c,g[c].has(b)),j[c].set("robotsPtTaxonomies",new Set(g[c]))});const l=(a,b)=>{d.trigger("tsf-taxonomy-robots-changed",[a,b,g[b]])},m=a=>{for(let b in g)if(g[b].has(a)){let d=document.getElementById(`${c(`${b}_taxonomies`)}[${a}]`),e=d.closest("label").querySelector(".tsf-taxonomy-from-pt-robots-warning");e.style.display=d.dataset.disabledWarning?"none":""}};d.on("tsf-taxonomy-support-changed",(a,b)=>m(b));let n=!1;const o=a=>{if(a.target.name){let b=a.target.name.split(/(?:.+\[)(.+?)(?:])/).join(""),c=a.target.dataset.robots;a.target.checked?(f[c].add(b),d.trigger("tsf-post-type-robots-changed",[b,c,f[c]])):n&&(f[c].delete(b),d.trigger("tsf-post-type-robots-changed",[b,c,f[c]]))}},p=new Event("change");document.querySelectorAll(".tsf-robots-post-types").forEach(a=>{a.addEventListener("change",o),a.dispatchEvent(p)}),n=!0},l=()=>{const a=["google_verification","bing_verification","yandex_verification","baidu_verification","pint_verification"].map(a=>document.getElementById(c(a))),b=a=>{let b=a.clipboardData&&a.clipboardData.getData("text")||"";if(b){let c=/<meta[^>]+content=(\"|\')?([^\"\'>\s]+)\1?.*?>/i.exec(b);c&&2 in c&&"string"==typeof c[2]&&c[2].length&&(a.stopPropagation(),a.preventDefault(),a.target.value=c[2],tsfAys.registerChange())}};a.forEach(a=>a.addEventListener("paste",b))},m=()=>{d(),f(),g(),h(),i(),j(),k(),l(),e()},n=()=>{const a=c("homepage_title"),b=c("homepage_description");tsfSocial.initTitleInputs({ref:document.getElementById("tsf-title-reference_"+a),refNa:document.getElementById("tsf-title-noadditions-reference_"+a),meta:document.getElementById(a),og:document.getElementById(c("homepage_og_title")),tw:document.getElementById(c("homepage_twitter_title"))}),tsfSocial.initDescriptionInputs({ref:document.getElementById("tsf-description-reference_"+b),meta:document.getElementById(b),og:document.getElementById(c("homepage_og_description")),tw:document.getElementById(c("homepage_twitter_description"))})},o=()=>{tsfTabs.initStack("tsfSettings",{tabToggledEvent:new CustomEvent("tsf-tab-toggled"),HTMLClasses:{wrapper:"tsf-nav-tab-wrapper",tabRadio:"tsf-tabs-radio",tabLabel:"tsf-nav-tab",activeTab:"tsf-tab-active",activeTabContent:"tsf-active-tab-content"},fixHistory:!0})};return Object.assign({load:()=>{a("div.updated, div.error, div.notice, .notice-error, .notice-warning, .notice-info").insertAfter(".wp-header-end"),document.body.addEventListener("tsf-onload",m),document.body.addEventListener("tsf-ready",n),o()}},{},{l10n:b})}(jQuery),window.tsfSettings.load();
